# Быстрый старт - Redux Toolkit: Комментарии к постам

## Шаг 1: Создание базы данных

Перед запуском приложения необходимо создать базу данных.

### 1.1. Откройте PostgreSQL
- Запустите psql в терминале

### 1.2. Создайте базу данных
```sql
CREATE DATABASE posts_comments_db;

\c posts_comments_db;
```

### 1.3. Выполните SQL скрипт
Откройте файл `СОЗДАНИЕ ТАБЛИЦ.sql` и выполните его в созданной базе данных.

**Проверка:**
```sql
SELECT * FROM posts;
SELECT * FROM comments;
```
Должны вернуться тестовые данные: 5 постов и несколько комментариев.

---

## Шаг 2: Настройка и запуск сервера

### 2.1. Перейдите в папку сервера
```bash
cd server
```

### 2.2. Установите зависимости
```bash
npm install
```

Будут установлены:
- `express` - веб-фреймворк
- `pg` - драйвер PostgreSQL
- `cors` - для работы с запросами с фронтенда

### 2.3. Настройте подключение к БД
Откройте файл `index.js` и измените параметры подключения:

```javascript
const pool = new Pool({
    user: 'postgres',              // ваш пользователь
    host: 'localhost',
    database: 'posts_comments_db',
    password: 'ваш_пароль',        // ваш пароль PostgreSQL
    port: 5432,
});
```

### 2.4. Запустите сервер
```bash
node index.js
```

Вы должны увидеть: `Сервер запущен по адресу http://localhost:5000`

**Проверка:** Откройте в браузере `http://localhost:5000/posts` - должен вернуться массив постов

---

## Шаг 3: Настройка и запуск клиента

### 3.1. Откройте НОВЫЙ терминал

### 3.2. Перейдите в папку клиента
```bash
cd client
```

### 3.3. Установите зависимости
```bash
npm install
```

Будут установлены:
- `react` и `react-dom` - React библиотека
- `@reduxjs/toolkit` - Redux Toolkit
- `react-redux` - связь между React и Redux
- `axios` - для HTTP запросов
- `vite` - сборщик проекта

### 3.4. Запустите приложение
```bash
npm run dev
```

Приложение откроется по адресу: **http://localhost:5173**

---

## Шаг 4: Что нужно сделать

Откройте файл **`ЗАДАЧА.md`** и выполните задачи по порядку.

### Последовательность выполнения:

#### Backend (сервер):
1. Создать и настроить базу данных
2. Реализовать API эндпоинты в `server/index.js`:
   - GET /posts
   - GET /comments/:postId
   - POST /comments
   - DELETE /comments/:id

#### Frontend (клиент):
3. **store/slices/commentsSlice.js** - создать slice с reducers
4. **store/slices/postsSlice.js** - создать slice для постов
5. **store/store.js** - настроить store с configureStore
6. **main.jsx** - подключить Provider
7. **App.jsx** - загрузка постов с сервера
8. **components/PostsList.jsx** - список постов
9. **components/CommentSection.jsx** - секция комментариев с формой
10. **components/CommentsList.jsx** - список комментариев

---

## Структура проекта

```
posts-comments-template/
├── client/                          ← Frontend
│   ├── src/
│   │   ├── store/                  ← Redux Toolkit логика (начните отсюда!)
│   │   │   ├── slices/
│   │   │   │   ├── commentsSlice.js    ← Задача 3
│   │   │   │   └── postsSlice.js       ← Задача 4
│   │   │   └── store.js                ← Задача 5
│   │   ├── components/             ← React компоненты
│   │   │   ├── PostsList.jsx          ← Задача 8
│   │   │   ├── CommentSection.jsx     ← Задача 9
│   │   │   └── CommentsList.jsx       ← Задача 10
│   │   ├── App.jsx                 ← Задача 7
│   │   └── main.jsx                ← Задача 6
│   └── package.json
├── server/                          ← Backend
│   ├── index.js                    ← Задачи 2 (API эндпоинты)
│   ├── package.json
│   └── README.md
└── СОЗДАНИЕ ТАБЛИЦ.sql             ← Задача 1
```

---

## Проверка работы

После выполнения всех задач приложение должно:

- ✅ Загружать посты с сервера при открытии страницы
- ✅ Позволять выбрать пост для просмотра комментариев
- ✅ Показывать все комментарии выбранного поста
- ✅ Позволять добавлять новые комментарии
- ✅ Позволять удалять комментарии
- ✅ Сохранять изменения в базе данных (данные остаются после перезагрузки)

---

## Остановка серверов

**Сервер (Backend):**
Нажмите `Ctrl+C` в терминале, где запущен сервер

**Клиент (Frontend):**
Нажмите `Ctrl+C` в терминале, где запущен Vite dev server

---

## Полезные команды

### Проверка базы данных:
```sql
-- Просмотр всех постов
SELECT * FROM posts;

-- Просмотр всех комментариев
SELECT * FROM comments;

-- Просмотр комментариев конкретного поста
SELECT * FROM comments WHERE post_id = 1;

-- Добавить тестовый комментарий
INSERT INTO comments (post_id, author, text) 
VALUES (1, 'Тестовый пользователь', 'Тестовый комментарий');

-- Очистить таблицу комментариев
TRUNCATE TABLE comments RESTART IDENTITY;
```

### Переустановка зависимостей:
```bash
# Удалить node_modules и установить заново
rm -rf node_modules package-lock.json
npm install
```

---

## Помощь

Если что-то не работает:

1. **Сервер не запускается** → Проверьте подключение к БД в `server/index.js`
2. **Клиент не запускается** → Убедитесь, что все зависимости установлены (`npm install`)
3. **CORS ошибка** → Убедитесь, что сервер использует `cors` middleware
4. **Данные не сохраняются** → Проверьте консоль браузера (DevTools → Console)
5. **Запросы не работают** → Проверьте Network в DevTools, убедитесь что сервер запущен

---

Удачи!

